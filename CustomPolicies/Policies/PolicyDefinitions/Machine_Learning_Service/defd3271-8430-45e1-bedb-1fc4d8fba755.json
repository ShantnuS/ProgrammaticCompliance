{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/defd3271-8430-45e1-bedb-1fc4d8fba755",
  "name": "defd3271-8430-45e1-bedb-1fc4d8fba755",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item NS-2 for Machine Learning Service",
    "displayName": "MCSB Baseline item NS-2 for Machine Learning Service",
    "metadata": {
      "offeringName": "Machine Learning Service",
      "offeringId": "72b76e95-fad8-45b8-9888-a61255034d11",
      "mcsb": {
        "mcsbId": "NS-2",
        "features": [
          {
            "featureId": "DISABLE_PUBLIC_NETWORK_ACCESS",
            "featureName": "Disable Public Network Access",
            "featureDescription": "Service supports disabling public network access either through using service-level IP ACL filtering rule (not NSG or Azure Firewall) or using a 'Disable Public Network Access' toggle switch.",
            "featureSupport": "True",
            "featureGuidance": "Disable public network access either using the service-level IP ACL filtering rule or a toggling switch for public network access.",
            "featureReference": "https://learn.microsoft.com/azure/machine-learning/how-to-configure-private-link#enable-public-accesss",
            "enabledByDefault": "False",
            "customerActionsDescription": "Secure cloud native services with network controls"
          },
          {
            "featureId": "PRIVATE_LINK_SUPPORT",
            "featureName": "Azure Private Link",
            "featureDescription": "Service native IP filtering capability for filtering network traffic (not to be confused with NSG or Azure Firewall).",
            "featureSupport": "True",
            "featureGuidance": "Deploy private endpoints for all Azure resources that support the Private Link feature, to establish a private access point for the resources.",
            "featureReference": "https://learn.microsoft.com/azure/machine-learning/how-to-configure-private-link",
            "enabledByDefault": "False",
            "customerActionsDescription": "Secure cloud native services with network controls"
          }
        ],
        "automatedPolicyAvailability": [
          {
            "policyId": "45e05259-1eb5-4f70-9574-baf73e9d219b",
            "policyName": "Azure Machine Learning workspaces should use private link",
            "policyDescription": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to Azure Machine Learning workspaces, data leakage risks are reduced. Learn more about private links at: https://docs.microsoft.com/azure/machine-learning/how-to-configure-private-link.",
            "policyCategory": "Machine Learning"
          },
          {
            "policyId": "438c38d2-3772-465a-a9cc-7a6666a275ce",
            "policyName": "Azure Machine Learning Workspaces should disable public network access",
            "policyDescription": "Disabling public network access improves security by ensuring that the Machine Learning Workspaces aren't exposed on the public internet. You can control exposure of your workspaces by creating private endpoints instead. Learn more at: https://learn.microsoft.com/azure/machine-learning/how-to-configure-private-link?view=azureml-api-2&tabs=azure-portal.",
            "policyCategory": "Machine Learning"
          },
          {
            "policyId": "7804b5c7-01dc-4723-969b-ae300cc07ff1",
            "policyName": "Azure Machine Learning Computes should be in a virtual network",
            "policyDescription": "Azure Virtual Networks provide enhanced security and isolation for your Azure Machine Learning Compute Clusters and Instances, as well as subnets, access control policies, and other features to further restrict access. When a compute is configured with a virtual network, it is not publicly addressable and can only be accessed from virtual machines and applications within the virtual network.",
            "policyCategory": "Machine Learning"
          }
        ],
        "frameworkControls": [
          "CIS_Azure_2.0.0_6.7",
          "CIS_Azure_2.0.0_5.1.3",
          "CIS_Azure_2.0.0_4.5.2",
          "CIS_Azure_2.0.0_4.5.1",
          "CIS_Azure_2.0.0_4.1.2",
          "CIS_Azure_2.0.0_3.10",
          "CIS_Azure_2.0.0_3.9",
          "CIS_Azure_2.0.0_3.8",
          "CIS_Azure_2.0.0_3.7",
          "NIST_SP_800-53_R4_SC-7",
          "NIST_SP_800-53_R4_SC-2",
          "NIST_SP_800-53_R4_AC-4",
          "PCI_DSS_v4.0_1.4.5",
          "PCI_DSS_v4.0_1.4.4",
          "PCI_DSS_v4.0_1.4.3",
          "PCI_DSS_v4.0_1.4.2",
          "PCI_DSS_v4.0_1.4.1",
          "PCI_DSS_v4.0_1.3.2",
          "PCI_DSS_v4.0_1.3.1",
          "PCI_DSS_v4.0_1.2.6"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}