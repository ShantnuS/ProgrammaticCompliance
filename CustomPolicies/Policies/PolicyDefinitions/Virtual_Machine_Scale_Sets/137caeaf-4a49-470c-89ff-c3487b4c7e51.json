{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/137caeaf-4a49-470c-89ff-c3487b4c7e51",
  "name": "137caeaf-4a49-470c-89ff-c3487b4c7e51",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item IM-1 for Virtual Machine Scale Sets",
    "displayName": "MCSB Baseline item IM-1 for Virtual Machine Scale Sets",
    "metadata": {
      "offeringName": "Virtual Machine Scale Sets",
      "offeringId": "d08cdbcb-2f75-4d31-9f0f-6d9d2913f214",
      "mcsb": {
        "mcsbId": "IM-1",
        "features": [
          {
            "featureId": "AAD_AUTH_FOR_DATA_PLANE_ACCESS",
            "featureName": "Azure AD Authentication Required for Data Plane Access",
            "featureDescription": "Service supports using Azure AD authentication for data plane access.",
            "featureSupport": "True",
            "featureGuidance": "Use Azure Active Directory (Azure AD) as the default authentication method to control your data plane access. Azure AD protects data by using strong encryption for data at rest and in transit. Azure AD also salts, hashes, and securely stores user credentials. You can use managed identities to authenticate to any service that supports Azure AD authentication, including Key Vault, without any credentials in your code. Your code that's running on a virtual machine, can use its managed identity to request access tokens for services that support Azure AD authentication.",
            "featureReference": "https://docs.microsoft.com/azure/active-directory/devices/azureadjoin-plan",
            "enabledByDefault": "False",
            "customerActionsDescription": "Use centralized identity and authentication system"
          },
          {
            "featureId": "LOCAL_AUTH_METHODS_FOR_DATA_PLANE_ACCESS",
            "featureName": "Local Authentication Methods for Data Plane Access",
            "featureDescription": "Local authentications methods supported for data plane access, such as a local username and password.",
            "featureSupport": "True",
            "featureGuidance": "No additional configurations are required as this is enabled on a default deployment.",
            "featureReference": "Not Applicable",
            "enabledByDefault": "True",
            "customerActionsDescription": "Use centralized identity and authentication system"
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "CIS_Azure_2.0.0_4.5.3",
          "CIS_Azure_2.0.0_9.5",
          "CIS_Azure_2.0.0_4.1.4",
          "NIST_SP_800-53_R4_AC-3",
          "NIST_SP_800-53_R4_AC-2",
          "NIST_SP_800-53_R4_IA-8",
          "NIST_SP_800-53_R4_IA-2",
          "PCI_DSS_v4.0_7.3.2",
          "PCI_DSS_v4.0_7.3.1",
          "PCI_DSS_v4.0_8.2.1"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}