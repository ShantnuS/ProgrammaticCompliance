{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/28e78692-4f98-4546-af2f-5fbb75af222b",
  "name": "28e78692-4f98-4546-af2f-5fbb75af222b",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item NS-1 for Virtual Machine Scale Sets",
    "displayName": "MCSB Baseline item NS-1 for Virtual Machine Scale Sets",
    "metadata": {
      "offeringName": "Virtual Machine Scale Sets",
      "offeringId": "d08cdbcb-2f75-4d31-9f0f-6d9d2913f214",
      "mcsb": {
        "mcsbId": "NS-1",
        "features": [
          {
            "featureId": "NSG_SUPPORTED",
            "featureName": "Network Security Group Support",
            "featureDescription": "Service network traffic respects Network Security Groups rule assignment on its subnets.",
            "featureSupport": "True",
            "featureGuidance": "Use network security groups (NSG) to restrict or monitor traffic by port, protocol, source IP address, or destination IP address. Create NSG rules to restrict your service's open ports (such as preventing management ports from being accessed from untrusted networks). Be aware that by default, NSGs deny all inbound traffic but allow traffic from virtual network and Azure Load Balancers.\r\n\r\nWhen you create an Azure virtual machine (VM), you must create a virtual network or use an existing virtual network and configure the VM with a subnet. Ensure that all deployed subnets have a Network Security Group applied with network access controls specific to your applications trusted ports and sources.",
            "featureReference": "https://docs.microsoft.com/azure/virtual-network/network-overview#network-security-groups",
            "enabledByDefault": "False",
            "customerActionsDescription": "Establish network segmentation boundaries "
          },
          {
            "featureId": "VNET_INTEGRATION",
            "featureName": "Virtual Network Integration",
            "featureDescription": "Service supports deployment into customer's private Virtual Network (VNet).",
            "featureSupport": "True",
            "featureGuidance": "No additional configurations are required as this is enabled on a default deployment.",
            "featureReference": "https://docs.microsoft.com/azure/virtual-network/network-overview",
            "enabledByDefault": "True",
            "customerActionsDescription": "Establish network segmentation boundaries "
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "CIS_Azure_2.0.0_6.7",
          "CIS_Azure_2.0.0_6.4",
          "CIS_Azure_2.0.0_6.3",
          "CIS_Azure_2.0.0_6.2",
          "CIS_Azure_2.0.0_6.1",
          "CIS_Azure_2.0.0_4.3.7",
          "NIST_SP_800-53_R4_AC-4",
          "NIST_SP_800-53_R4_SC-7",
          "NIST_SP_800-53_R4_SC-2",
          "PCI_DSS_v4.0_1.4.5",
          "PCI_DSS_v4.0_1.4.4",
          "PCI_DSS_v4.0_1.4.3",
          "PCI_DSS_v4.0_1.4.2",
          "PCI_DSS_v4.0_1.4.1",
          "PCI_DSS_v4.0_1.3.2",
          "PCI_DSS_v4.0_1.3.1",
          "PCI_DSS_v4.0_1.2.6"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}