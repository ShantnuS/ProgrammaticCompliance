{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/7962e00f-4540-45e8-a5ca-d3bc21d3e680",
  "name": "7962e00f-4540-45e8-a5ca-d3bc21d3e680",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item PV-3 for Virtual Machine Scale Sets",
    "displayName": "MCSB Baseline item PV-3 for Virtual Machine Scale Sets",
    "metadata": {
      "offeringName": "Virtual Machine Scale Sets",
      "offeringId": "d08cdbcb-2f75-4d31-9f0f-6d9d2913f214",
      "mcsb": {
        "mcsbId": "PV-3",
        "features": [
          {
            "featureId": "AZURE_AUTOMATION_STATE_CONFIGURATION",
            "featureName": "Azure Automation State Configuration",
            "featureDescription": "Azure Automation State Configuration can be used to maintain the security configuration of the operating system.",
            "featureSupport": "True",
            "featureGuidance": "Use Azure Automation State Configuration to maintain the security configuration of the operating system. Azure Automation State Configuration is an Azure configuration management service that allows you to write, manage, and compile PowerShell Desired State Configuration (DSC) configurations for nodes.\r\n\r\nAzure Automation State Configuration provides several advantages over the use of DSC outside of Azure. This service enables scalability across thousands of machines quickly and easily from a central, secure location. You can easily enable machines, assign them declarative configurations, and view reports showing each machine's compliance with the desired state you specify.",
            "featureReference": "https://docs.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-dsc",
            "enabledByDefault": "False",
            "customerActionsDescription": "Define and establish secure configurations for compute resources"
          },
          {
            "featureId": "AZURE_POLICY_GUEST_CONFIGURATION_AGENT",
            "featureName": "Azure Policy Guest Configuration Agent",
            "featureDescription": "Azure Policy guest configuration agent can be installed or deployed as an extension to compute resources.",
            "featureSupport": "True",
            "featureGuidance": "Use Microsoft Defender for Cloud and Azure Policy guest configuration agent to regularly assess and remediate configuration deviations on your virtual machines.",
            "featureReference": "https://docs.microsoft.com/azure/governance/policy/concepts/guest-configuration",
            "enabledByDefault": "False",
            "customerActionsDescription": "Define and establish secure configurations for compute resources"
          },
          {
            "featureId": "CUSTOM_CONTAINER_IMAGE_SUPPORTED",
            "featureName": "Custom Containers Images",
            "featureDescription": "Service supports using user-supplied container images or pre-built images from the marketplace with certain baseline configurations pre-applied.",
            "featureSupport": "Not Applicable",
            "featureGuidance": "This feature is not applicable to secure this service.",
            "featureReference": "Not Applicable",
            "enabledByDefault": "Not Applicable",
            "customerActionsDescription": "Define and establish secure configurations for compute resources"
          },
          {
            "featureId": "CUSTOM_MACHINE_OR_CONTAINER_IMAGE_SUPPORTED",
            "featureName": "Custom VM Images",
            "featureDescription": "Service supports using user-supplied VM images or pre-built images from the marketplace with certain baseline configurations pre-applied.",
            "featureSupport": "True",
            "featureGuidance": "Use a pre-configured hardened image from a trusted supplier such as Microsoft or build a desired secure configuration baseline into the VM image template",
            "featureReference": "https://docs.microsoft.com/azure/virtual-machine-scale-sets/tutorial-use-custom-image-powershell",
            "enabledByDefault": "False",
            "customerActionsDescription": "Define and establish secure configurations for compute resources"
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "CIS_Azure_2.0.0_9.9",
          "CIS_Azure_2.0.0_9.8",
          "CIS_Azure_2.0.0_9.7",
          "CIS_Azure_2.0.0_9.6",
          "NIST_SP_800-53_R4_CM-6",
          "NIST_SP_800-53_R4_CM-2",
          "PCI_DSS_v4.0_2.2.1",
          "PCI_DSS_v4.0_2.2.6",
          "PCI_DSS_v4.0_2.2.5",
          "PCI_DSS_v4.0_2.2.4"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}