{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/03b3de97-b370-421b-b844-218035670117",
  "name": "03b3de97-b370-421b-b844-218035670117",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item NS-2 for Azure Cosmos DB",
    "displayName": "MCSB Baseline item NS-2 for Azure Cosmos DB",
    "metadata": {
      "offeringName": "Azure Cosmos DB",
      "offeringId": "86ec4e3b-1865-4240-89f6-c2f3553df5ac",
      "mcsb": {
        "mcsbId": "NS-2",
        "features": [
          {
            "featureId": "DISABLE_PUBLIC_NETWORK_ACCESS",
            "featureName": "Disable Public Network Access",
            "featureDescription": "Service supports disabling public network access either through using service-level IP ACL filtering rule (not NSG or Azure Firewall) or using a 'Disable Public Network Access' toggle switch.",
            "featureSupport": "True",
            "featureGuidance": "Disable public network access either using the service-level IP ACL filtering rule or a toggling switch for public network access.",
            "featureReference": "https://docs.microsoft.com/azure/cosmos-db/how-to-configure-firewall",
            "enabledByDefault": "False",
            "customerActionsDescription": "Secure cloud native services with network controls"
          },
          {
            "featureId": "PRIVATE_LINK_SUPPORT",
            "featureName": "Azure Private Link",
            "featureDescription": "Service native IP filtering capability for filtering network traffic (not to be confused with NSG or Azure Firewall).",
            "featureSupport": "True",
            "featureGuidance": "Deploy private endpoints for all Azure resources that support the Private Link feature, to establish a private access point for the resources.",
            "featureReference": "https://docs.microsoft.com/azure/cosmos-db/how-to-configure-private-endpoints",
            "enabledByDefault": "False",
            "customerActionsDescription": "Secure cloud native services with network controls"
          }
        ],
        "automatedPolicyAvailability": [
          {
            "policyId": "862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb",
            "policyName": "Azure Cosmos DB accounts should have firewall rules",
            "policyDescription": "Firewall rules should be defined on your Azure Cosmos DB accounts to prevent traffic from unauthorized sources. Accounts that have at least one IP rule defined with the virtual network filter enabled are deemed compliant. Accounts disabling public access are also deemed compliant.",
            "policyCategory": "Cosmos DB"
          },
          {
            "policyId": "797b37f7-06b8-444c-b1ad-fc62867f335a",
            "policyName": "Azure Cosmos DB should disable public network access",
            "policyDescription": "Disabling public network access improves security by ensuring that your CosmosDB account isn't exposed on the public internet. Creating private endpoints can limit exposure of your CosmosDB account. Learn more at: https://docs.microsoft.com/azure/cosmos-db/how-to-configure-private-endpoints#blocking-public-network-access-during-account-creation.",
            "policyCategory": "Cosmos DB"
          },
          {
            "policyId": "58440f8a-10c5-4151-bdce-dfbaad4a20b7",
            "policyName": "CosmosDB accounts should use private link",
            "policyDescription": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your CosmosDB account, data leakage risks are reduced. Learn more about private links at: https://docs.microsoft.com/azure/cosmos-db/how-to-configure-private-endpoints.",
            "policyCategory": "Cosmos DB"
          }
        ],
        "frameworkControls": [
          "CIS_Azure_2.0.0_6.7",
          "CIS_Azure_2.0.0_5.1.3",
          "CIS_Azure_2.0.0_4.5.2",
          "CIS_Azure_2.0.0_4.5.1",
          "CIS_Azure_2.0.0_4.1.2",
          "CIS_Azure_2.0.0_3.10",
          "CIS_Azure_2.0.0_3.9",
          "CIS_Azure_2.0.0_3.8",
          "CIS_Azure_2.0.0_3.7",
          "NIST_SP_800-53_R4_SC-7",
          "NIST_SP_800-53_R4_SC-2",
          "NIST_SP_800-53_R4_AC-4",
          "PCI_DSS_v4.0_1.4.5",
          "PCI_DSS_v4.0_1.4.4",
          "PCI_DSS_v4.0_1.4.3",
          "PCI_DSS_v4.0_1.4.2",
          "PCI_DSS_v4.0_1.4.1",
          "PCI_DSS_v4.0_1.3.2",
          "PCI_DSS_v4.0_1.3.1",
          "PCI_DSS_v4.0_1.2.6"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}