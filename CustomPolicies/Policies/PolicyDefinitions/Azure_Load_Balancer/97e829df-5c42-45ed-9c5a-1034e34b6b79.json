{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/97e829df-5c42-45ed-9c5a-1034e34b6b79",
  "name": "97e829df-5c42-45ed-9c5a-1034e34b6b79",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item NS-1 for Azure Load Balancer",
    "displayName": "MCSB Baseline item NS-1 for Azure Load Balancer",
    "metadata": {
      "offeringName": "Azure Load Balancer",
      "offeringId": "079f48f1-1f76-40dc-899e-2940b9f1c63c",
      "mcsb": {
        "mcsbId": "NS-1",
        "features": [
          {
            "featureId": "NSG_SUPPORTED",
            "featureName": "Network Security Group Support",
            "featureDescription": "Service network traffic respects Network Security Groups rule assignment on its subnets.",
            "featureSupport": "True",
            "featureGuidance": "Implement network security groups and only allow access to your application's trusted ports and IP address ranges. In cases where there is no network security group assigned to the backend subnet or NIC of the backend virtual machines, traffic will not be allowed to access these resources from the load balancer. Standard Load Balancers provide outbound rules to define outbound NAT with a network security group. Review these outbound rules to tune the behavior of your outbound connections.\r\n\r\nThe Standard Load Balancer is designed to be secure by default and part of a private and isolated Virtual Network. It is closed to inbound flows unless opened by network security groups to explicitly permit allowed traffic, and to disallow known malicious IP addresses. Unless a network security group on a subnet or NIC of your virtual machine resource exists behind the Load Balancer, traffic is not allowed to reach this resource.",
            "featureReference": "https://docs.microsoft.com/azure/load-balancer/components#frontend-ip-configuration",
            "enabledByDefault": "False",
            "customerActionsDescription": "Establish network segmentation boundaries "
          },
          {
            "featureId": "VNET_INTEGRATION",
            "featureName": "Virtual Network Integration",
            "featureDescription": "Service supports deployment into customer's private Virtual Network (VNet).",
            "featureSupport": "True",
            "featureGuidance": "Azure offers two types of Load Balancer offerings, Standard and Basic. Use internal Azure Load Balancers to only allow traffic to backend resources from within certain virtual networks or peered virtual networks without exposure to the internet. Implement an external Load Balancer with Source Network Address Translation (SNAT) to masquerade the IP addresses of backend resources for protection from direct internet exposure.",
            "featureReference": "https://docs.microsoft.com/azure/load-balancer/components#frontend-ip-configuration",
            "enabledByDefault": "False",
            "customerActionsDescription": "Establish network segmentation boundaries "
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "CIS_Azure_2.0.0_6.7",
          "CIS_Azure_2.0.0_6.4",
          "CIS_Azure_2.0.0_6.3",
          "CIS_Azure_2.0.0_6.2",
          "CIS_Azure_2.0.0_6.1",
          "CIS_Azure_2.0.0_4.3.7",
          "NIST_SP_800-53_R4_SC-7",
          "NIST_SP_800-53_R4_SC-2",
          "NIST_SP_800-53_R4_AC-4",
          "PCI_DSS_v4.0_1.4.5",
          "PCI_DSS_v4.0_1.4.4",
          "PCI_DSS_v4.0_1.4.3",
          "PCI_DSS_v4.0_1.4.2",
          "PCI_DSS_v4.0_1.4.1",
          "PCI_DSS_v4.0_1.3.2",
          "PCI_DSS_v4.0_1.3.1",
          "PCI_DSS_v4.0_1.2.6"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}