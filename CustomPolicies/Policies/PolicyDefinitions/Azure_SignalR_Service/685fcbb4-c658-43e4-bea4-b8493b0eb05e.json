{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/685fcbb4-c658-43e4-bea4-b8493b0eb05e",
  "name": "685fcbb4-c658-43e4-bea4-b8493b0eb05e",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item NS-2 for Azure SignalR Service",
    "displayName": "MCSB Baseline item NS-2 for Azure SignalR Service",
    "metadata": {
      "offeringName": "Azure SignalR Service",
      "offeringId": "fd9f5052-b5d2-4791-95af-be1e1ab2071f",
      "mcsb": {
        "mcsbId": "NS-2",
        "features": [
          {
            "featureId": "DISABLE_PUBLIC_NETWORK_ACCESS",
            "featureName": "Disable Public Network Access",
            "featureDescription": "Service supports disabling public network access either through using service-level IP ACL filtering rule (not NSG or Azure Firewall) or using a 'Disable Public Network Access' toggle switch.",
            "featureSupport": "True",
            "featureGuidance": "To completely deny all public traffic, you should first configure the public network rule to allow no request type. Then, you should configure rules that grant access to traffic from specific VNets. This configuration enables you to build a secure network boundary for your applications.",
            "featureReference": "https://docs.microsoft.com/azure/azure-signalr/howto-network-access-control",
            "enabledByDefault": "False",
            "customerActionsDescription": "Secure cloud native services with network controls"
          },
          {
            "featureId": "PRIVATE_LINK_SUPPORT",
            "featureName": "Azure Private Link",
            "featureDescription": "Service native IP filtering capability for filtering network traffic (not to be confused with NSG or Azure Firewall).",
            "featureSupport": "True",
            "featureGuidance": "No additional configurations are required as this is enabled on a default deployment.",
            "featureReference": "https://docs.microsoft.com/azure/azure-signalr/howto-private-endpoints",
            "enabledByDefault": "True",
            "customerActionsDescription": "Secure cloud native services with network controls"
          }
        ],
        "automatedPolicyAvailability": [
          {
            "policyId": "2393d2cf-a342-44cd-a2e2-fe0188fd1234",
            "policyName": "Azure SignalR Service should use private link",
            "policyDescription": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The private link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your Azure SignalR Service resource instead of the entire service, you'll reduce your data leakage risks. Learn more about private links at: https://aka.ms/asrs/privatelink.",
            "policyCategory": "SignalR"
          }
        ],
        "frameworkControls": [
          "CIS_Azure_2.0.0_6.7",
          "CIS_Azure_2.0.0_5.1.3",
          "CIS_Azure_2.0.0_4.5.2",
          "CIS_Azure_2.0.0_4.5.1",
          "CIS_Azure_2.0.0_4.1.2",
          "CIS_Azure_2.0.0_3.10",
          "CIS_Azure_2.0.0_3.9",
          "CIS_Azure_2.0.0_3.8",
          "CIS_Azure_2.0.0_3.7",
          "NIST_SP_800-53_R4_SC-7",
          "NIST_SP_800-53_R4_SC-2",
          "NIST_SP_800-53_R4_AC-4",
          "PCI_DSS_v4.0_1.4.5",
          "PCI_DSS_v4.0_1.4.4",
          "PCI_DSS_v4.0_1.4.3",
          "PCI_DSS_v4.0_1.4.2",
          "PCI_DSS_v4.0_1.4.1",
          "PCI_DSS_v4.0_1.3.2",
          "PCI_DSS_v4.0_1.3.1",
          "PCI_DSS_v4.0_1.2.6"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}