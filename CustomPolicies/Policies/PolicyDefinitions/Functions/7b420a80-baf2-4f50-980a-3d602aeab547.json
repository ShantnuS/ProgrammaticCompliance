{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/7b420a80-baf2-4f50-980a-3d602aeab547",
  "name": "7b420a80-baf2-4f50-980a-3d602aeab547",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item DP-3 for Functions",
    "displayName": "MCSB Baseline item DP-3 for Functions",
    "metadata": {
      "offeringName": "Functions",
      "offeringId": "416a6682-973a-4dc0-9f3c-bfc3360a9db4",
      "mcsb": {
        "mcsbId": "DP-3",
        "features": [
          {
            "featureId": "DATA_IN_TRANSIT_ENCRYPTION",
            "featureName": "Data in Transit Encryption",
            "featureDescription": "Service supports data in-transit encryption for data plane.",
            "featureSupport": "True",
            "featureGuidance": "Enable secure transfer in services where there is a native data in transit encryption feature built in. Enforce HTTPS on any web applications and services and ensure TLS v1.2 or later is used. Legacy versions such as SSL 3.0, TLS v1.0 should be disabled. For remote management of Virtual Machines, use SSH (for Linux) or RDP/TLS (for Windows) instead of an unencrypted protocol.",
            "featureReference": "https://learn.microsoft.com/azure/app-service/configure-ssl-certificate?toc=%2Fazure%2Fazure-functions%2Ftoc.json&tabs=apex%2Cportal",
            "enabledByDefault": "False",
            "customerActionsDescription": "Encrypt sensitive data in transit"
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "CIS_Azure_2.0.0_2.1.5",
          "CIS_Azure_2.0.0_9.3",
          "CIS_Azure_2.0.0_9.2",
          "CIS_Azure_2.0.0_4.4.1",
          "CIS_Azure_2.0.0_3.15",
          "NIST_SP_800-53_R4_SC-8",
          "PCI_DSS_v4.0_4.2.2",
          "PCI_DSS_v4.0_4.2.1.2",
          "PCI_DSS_v4.0_2.2.7"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}