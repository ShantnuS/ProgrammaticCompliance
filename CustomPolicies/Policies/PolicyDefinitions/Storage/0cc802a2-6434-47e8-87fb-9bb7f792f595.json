{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/0cc802a2-6434-47e8-87fb-9bb7f792f595",
  "name": "0cc802a2-6434-47e8-87fb-9bb7f792f595",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item NS-2 for Storage",
    "displayName": "MCSB Baseline item NS-2 for Storage",
    "metadata": {
      "offeringName": "Storage",
      "offeringId": "c6b94711-f1f5-4e7e-9c89-c17ed4190969",
      "mcsb": {
        "mcsbId": "NS-2",
        "features": [
          {
            "featureId": "DISABLE_PUBLIC_NETWORK_ACCESS",
            "featureName": "Disable Public Network Access",
            "featureDescription": "Service supports disabling public network access either through using service-level IP ACL filtering rule (not NSG or Azure Firewall) or using a 'Disable Public Network Access' toggle switch.",
            "featureSupport": "True",
            "featureGuidance": "Disable public network access by either using Azure Storage service-level IP ACL filtering or a toggling switch for public network access.",
            "featureReference": "https://docs.microsoft.com/azure/storage/common/storage-network-security?tabs=azure-portal#change-the-default-network-access-rule",
            "enabledByDefault": "False",
            "customerActionsDescription": "Secure cloud native services with network controls"
          },
          {
            "featureId": "PRIVATE_LINK_SUPPORT",
            "featureName": "Azure Private Link",
            "featureDescription": "Service native IP filtering capability for filtering network traffic (not to be confused with NSG or Azure Firewall).",
            "featureSupport": "True",
            "featureGuidance": "Deploy private endpoints for Azure Storage to establish a private access point for the resources.",
            "featureReference": "https://docs.microsoft.com/azure/storage/common/storage-private-endpoints",
            "enabledByDefault": "False",
            "customerActionsDescription": "Secure cloud native services with network controls"
          }
        ],
        "automatedPolicyAvailability": [
          {
            "policyId": "34c877ad-507e-4c82-993e-3452a6e0ad3c",
            "policyName": "Storage accounts should restrict network access",
            "policyDescription": "Network access to storage accounts should be restricted. Configure network rules so only applications from allowed networks can access the storage account. To allow connections from specific internet or on-premises clients, access can be granted to traffic from specific Azure virtual networks or to public internet IP address ranges",
            "policyCategory": "Storage"
          },
          {
            "policyId": "2a1a9cdf-e04d-429a-8416-3bfb72a1b26f",
            "policyName": "Storage accounts should restrict network access using virtual network rules",
            "policyDescription": "Protect your storage accounts from potential threats using virtual network rules as a preferred method instead of IP-based filtering. Disabling IP-based filtering prevents public IPs from accessing your storage accounts.",
            "policyCategory": "Storage"
          },
          {
            "policyId": "6edd7eda-6dd8-40f7-810d-67160c639cd9",
            "policyName": "Storage accounts should use private link",
            "policyDescription": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your storage account, data leakage risks are reduced. Learn more about private links at - https://aka.ms/azureprivatelinkoverview",
            "policyCategory": "Storage"
          }
        ],
        "frameworkControls": [
          "CIS_Azure_2.0.0_6.7",
          "CIS_Azure_2.0.0_5.1.3",
          "CIS_Azure_2.0.0_4.5.2",
          "CIS_Azure_2.0.0_4.5.1",
          "CIS_Azure_2.0.0_4.1.2",
          "CIS_Azure_2.0.0_3.10",
          "CIS_Azure_2.0.0_3.9",
          "CIS_Azure_2.0.0_3.8",
          "CIS_Azure_2.0.0_3.7",
          "NIST_SP_800-53_R4_SC-7",
          "NIST_SP_800-53_R4_SC-2",
          "NIST_SP_800-53_R4_AC-4",
          "PCI_DSS_v4.0_1.4.5",
          "PCI_DSS_v4.0_1.4.4",
          "PCI_DSS_v4.0_1.4.3",
          "PCI_DSS_v4.0_1.4.2",
          "PCI_DSS_v4.0_1.4.1",
          "PCI_DSS_v4.0_1.3.2",
          "PCI_DSS_v4.0_1.3.1",
          "PCI_DSS_v4.0_1.2.6"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}