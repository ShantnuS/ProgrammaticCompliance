{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/a12778cb-4729-4048-9c44-1fe0a7412b32",
  "name": "a12778cb-4729-4048-9c44-1fe0a7412b32",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item LT-1 for Storage",
    "displayName": "MCSB Baseline item LT-1 for Storage",
    "metadata": {
      "offeringName": "Storage",
      "offeringId": "c6b94711-f1f5-4e7e-9c89-c17ed4190969",
      "mcsb": {
        "mcsbId": "LT-1",
        "features": [
          {
            "featureId": "DEFENDER_FOR_SERVICE_SUPPORT",
            "featureName": "Microsoft Defender for Service / Product Offering",
            "featureDescription": "Service has an offering-specific Microsoft Defender solution to monitor and alert on security issues.",
            "featureSupport": "True",
            "featureGuidance": "Use Microsoft Defender for Storage to provide an additional layer of security intelligence that detects unusual and potentially harmful attempts to access or exploit storage accounts.  It uses advanced threat detection capabilities and Microsoft Threat Intelligence data to provide contextual security alerts. Those alerts also include steps to mitigate the detected threats and prevent future attacks.",
            "featureReference": "https://docs.microsoft.com/azure/defender-for-cloud/defender-for-storage-introduction",
            "enabledByDefault": "False",
            "customerActionsDescription": "Enable threat detection capabilities"
          }
        ],
        "automatedPolicyAvailability": [
          {
            "policyId": "308fbb08-4ab8-4e67-9b29-592e93fb94fa",
            "policyName": "Microsoft Defender for Storage (Classic) should be enabled",
            "policyDescription": "Microsoft Defender for Storage (Classic) provides detections of unusual and potentially harmful attempts to access or exploit storage accounts.",
            "policyCategory": "Security Center"
          },
          {
            "policyId": "640d2586-54d2-465f-877f-9ffc1d2109f4",
            "policyName": "Microsoft Defender for Storage should be enabled",
            "policyDescription": "Microsoft Defender for Storage detects potential threats to your storage accounts. It helps prevent the three major impacts on your data and workload: malicious file uploads, sensitive data exfiltration, and data corruption. The new Defender for Storage plan includes Malware Scanning and Sensitive Data Threat Detection. This plan also provides a predictable pricing structure (per storage account) for control over coverage and costs.",
            "policyCategory": "Security Center"
          }
        ],
        "frameworkControls": [
          "CIS_Azure_2.0.0_2.1.5",
          "CIS_Azure_2.0.0_2.1.6",
          "CIS_Azure_2.0.0_2.1.4",
          "CIS_Azure_2.0.0_2.2.1",
          "CIS_Azure_2.0.0_2.1.12",
          "CIS_Azure_2.0.0_2.1.11",
          "CIS_Azure_2.0.0_2.1.10",
          "CIS_Azure_2.0.0_2.1.9",
          "CIS_Azure_2.0.0_2.1.8",
          "CIS_Azure_2.0.0_2.1.7",
          "CIS_Azure_2.0.0_2.1.3",
          "CIS_Azure_2.0.0_2.1.2",
          "NIST_SP_800-53_R4_SI-4",
          "NIST_SP_800-53_R4_AU-12",
          "NIST_SP_800-53_R4_AU-6",
          "NIST_SP_800-53_R4_AU-3",
          "PCI_DSS_v4.0_10.7.3",
          "PCI_DSS_v4.0_10.7.2",
          "PCI_DSS_v4.0_10.7.1",
          "PCI_DSS_v4.0_10.4.3",
          "PCI_DSS_v4.0_10.4.2",
          "PCI_DSS_v4.0_10.4.1",
          "PCI_DSS_v4.0_10.2.2",
          "PCI_DSS_v4.0_10.2.1"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}