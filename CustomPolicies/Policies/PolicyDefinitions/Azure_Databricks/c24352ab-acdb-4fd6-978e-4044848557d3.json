{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/c24352ab-acdb-4fd6-978e-4044848557d3",
  "name": "c24352ab-acdb-4fd6-978e-4044848557d3",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item NS-2 for Azure Databricks",
    "displayName": "MCSB Baseline item NS-2 for Azure Databricks",
    "metadata": {
      "offeringName": "Azure Databricks",
      "offeringId": "5657a36c-dee6-44fb-b0f5-1f2cea67613f",
      "mcsb": {
        "mcsbId": "NS-2",
        "features": [
          {
            "featureId": "DISABLE_PUBLIC_NETWORK_ACCESS",
            "featureName": "Disable Public Network Access",
            "featureDescription": "Service supports disabling public network access either through using service-level IP ACL filtering rule (not NSG or Azure Firewall) or using a 'Disable Public Network Access' toggle switch.",
            "featureSupport": "True",
            "featureGuidance": "Azure Databricks customers can use the IP access lists feature to define a set of approved IP addresses to prevent access from public IP or unapproved IP addresses.",
            "featureReference": "https://docs.microsoft.com/azure/databricks/security/network/ip-access-list",
            "enabledByDefault": "False",
            "customerActionsDescription": "Secure cloud native services with network controls"
          },
          {
            "featureId": "PRIVATE_LINK_SUPPORT",
            "featureName": "Azure Private Link",
            "featureDescription": "Service native IP filtering capability for filtering network traffic (not to be confused with NSG or Azure Firewall).",
            "featureSupport": "False",
            "featureGuidance": "This feature is not supported to secure this service.",
            "featureReference": "Not Applicable",
            "enabledByDefault": "Not Applicable",
            "customerActionsDescription": "Secure cloud native services with network controls"
          }
        ],
        "automatedPolicyAvailability": [
          {
            "policyId": "0e7849de-b939-4c50-ab48-fc6b0f5eeba2",
            "policyName": "Azure Databricks Workspaces should disable public network access",
            "policyDescription": "Disabling public network access improves security by ensuring that the resource isn't exposed on the public internet. You can control exposure of your resources by creating private endpoints instead. Learn more at: https://learn.microsoft.com/azure/databricks/administration-guide/cloud-configurations/azure/private-link. ",
            "policyCategory": "Azure Databricks"
          },
          {
            "policyId": "51c1490f-3319-459c-bbbc-7f391bbed753",
            "policyName": "Azure Databricks Clusters should disable public IP",
            "policyDescription": "Disabling public IP of clusters in Azure Databricks Workspaces improves security by ensuring that the clusters aren't exposed on the public internet. Learn more at: https://learn.microsoft.com/azure/databricks/security/secure-cluster-connectivity.",
            "policyCategory": "Azure Databricks"
          },
          {
            "policyId": "9c25c9e4-ee12-4882-afd2-11fb9d87893f",
            "policyName": "Azure Databricks Workspaces should be in a virtual network",
            "policyDescription": "Azure Virtual Networks provide enhanced security and isolation for your Azure Databricks Workspaces, as well as subnets, access control policies, and other features to further restrict access. Learn more at: https://docs.microsoft.com/azure/databricks/administration-guide/cloud-configurations/azure/vnet-inject.",
            "policyCategory": "Azure Databricks"
          },
          {
            "policyId": "258823f2-4595-4b52-b333-cc96192710d8",
            "policyName": "Azure Databricks Workspaces should use private link",
            "policyDescription": "Azure Private Link lets you connect your virtual networks to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to Azure Databricks workspaces, you can reduce data leakage risks. Learn more about private links at: https://aka.ms/adbpe.",
            "policyCategory": "Azure Databricks"
          }
        ],
        "frameworkControls": [
          "CIS_Azure_2.0.0_6.7",
          "CIS_Azure_2.0.0_5.1.3",
          "CIS_Azure_2.0.0_4.5.2",
          "CIS_Azure_2.0.0_4.5.1",
          "CIS_Azure_2.0.0_4.1.2",
          "CIS_Azure_2.0.0_3.10",
          "CIS_Azure_2.0.0_3.9",
          "CIS_Azure_2.0.0_3.8",
          "CIS_Azure_2.0.0_3.7",
          "NIST_SP_800-53_R4_SC-7",
          "NIST_SP_800-53_R4_SC-2",
          "NIST_SP_800-53_R4_AC-4",
          "PCI_DSS_v4.0_1.4.5",
          "PCI_DSS_v4.0_1.4.4",
          "PCI_DSS_v4.0_1.4.3",
          "PCI_DSS_v4.0_1.4.2",
          "PCI_DSS_v4.0_1.4.1",
          "PCI_DSS_v4.0_1.3.2",
          "PCI_DSS_v4.0_1.3.1",
          "PCI_DSS_v4.0_1.2.6"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}