{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/66299a99-3f9d-4b95-afae-5868b76a3508",
  "name": "66299a99-3f9d-4b95-afae-5868b76a3508",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item IM-1 for Azure SQL",
    "displayName": "MCSB Baseline item IM-1 for Azure SQL",
    "metadata": {
      "offeringName": "Azure SQL",
      "offeringId": "1c017867-b3d9-4798-979e-9693c49579f8",
      "mcsb": {
        "mcsbId": "IM-1",
        "features": [
          {
            "featureId": "AAD_AUTH_FOR_DATA_PLANE_ACCESS",
            "featureName": "Azure AD Authentication Required for Data Plane Access",
            "featureDescription": "Service supports using Azure AD authentication for data plane access.",
            "featureSupport": "True",
            "featureGuidance": "Use Azure Active Directory (Azure AD) as the default authentication method to control your data plane access.",
            "featureReference": "https://docs.microsoft.com/azure/azure-sql/database/authentication-aad-overview?view=azuresql",
            "enabledByDefault": "False",
            "customerActionsDescription": "Use centralized identity and authentication system"
          },
          {
            "featureId": "LOCAL_AUTH_METHODS_FOR_DATA_PLANE_ACCESS",
            "featureName": "Local Authentication Methods for Data Plane Access",
            "featureDescription": "Local authentications methods supported for data plane access, such as a local username and password.",
            "featureSupport": "True",
            "featureGuidance": "Restrict the use of local authentication methods for data plane access. Instead, use Azure Active Directory (Azure AD) as the default authentication method to control your data plane access.",
            "featureReference": "https://learn.microsoft.com/azure/azure-sql/database/logins-create-manage?view=azuresql#create-additional-logins-and-users-having-administrative-permissions",
            "enabledByDefault": "False",
            "customerActionsDescription": "Use centralized identity and authentication system"
          }
        ],
        "automatedPolicyAvailability": [
          {
            "policyId": "1f314764-cb73-4fc9-b863-8eca98ac36e9",
            "policyName": "An Azure Active Directory administrator should be provisioned for SQL servers",
            "policyDescription": "Audit provisioning of an Azure Active Directory administrator for your SQL server to enable Azure AD authentication. Azure AD authentication enables simplified permission management and centralized identity management of database users and other Microsoft services",
            "policyCategory": "SQL"
          }
        ],
        "frameworkControls": [
          "CIS_Azure_2.0.0_9.5",
          "CIS_Azure_2.0.0_4.5.3",
          "CIS_Azure_2.0.0_4.1.4",
          "NIST_SP_800-53_R4_IA-8",
          "NIST_SP_800-53_R4_IA-2",
          "NIST_SP_800-53_R4_AC-3",
          "NIST_SP_800-53_R4_AC-2",
          "PCI_DSS_v4.0_8.2.1",
          "PCI_DSS_v4.0_7.3.2",
          "PCI_DSS_v4.0_7.3.1"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}