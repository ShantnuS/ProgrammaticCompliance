{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/8171bf8f-16a5-4f45-9745-7b150daded69",
  "name": "8171bf8f-16a5-4f45-9745-7b150daded69",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item NS-1 for Azure Data Explorer",
    "displayName": "MCSB Baseline item NS-1 for Azure Data Explorer",
    "metadata": {
      "offeringName": "Azure Data Explorer",
      "offeringId": "f69180f4-2eea-4124-a08d-c8ab3663a249",
      "mcsb": {
        "mcsbId": "NS-1",
        "features": [
          {
            "featureId": "NSG_SUPPORTED",
            "featureName": "Network Security Group Support",
            "featureDescription": "Service network traffic respects Network Security Groups rule assignment on its subnets.",
            "featureSupport": "True",
            "featureGuidance": "In case you decide to inject Azure Data Explorer into a virtual network (a private endpoint-based solution is highly recommended) we require you to use subnet delegation for your cluster's deployment. To do so, you must delegate the subnet to Microsoft.Kusto/clusters before creating the cluster in the subnet.\r\n\r\nBy enabling subnet delegation on the cluster's subnet, you enable the service to define its pre-conditions for deployment in the form of Network Intent Policies. When creating the cluster in the subnet, the NSG configurations mentioned in the following sections are automatically created for you.",
            "featureReference": "https://docs.microsoft.com/azure/data-explorer/vnet-deployment#configure-network-security-group-rules",
            "enabledByDefault": "False",
            "customerActionsDescription": "Establish network segmentation boundaries "
          },
          {
            "featureId": "VNET_INTEGRATION",
            "featureName": "Virtual Network Integration",
            "featureDescription": "Service supports deployment into customer's private Virtual Network (VNet).",
            "featureSupport": "True",
            "featureGuidance": "Deploy Azure Data Explorer cluster into a subnet in your Virtual Network (VNet). This will allow you to implement NSG rules to restrict on your Azure Data Explorer cluster traffic and connect your on-premises network to Azure Data Explorer cluster's subnet.",
            "featureReference": "https://docs.microsoft.com/azure/data-explorer/vnet-deployment",
            "enabledByDefault": "False",
            "customerActionsDescription": "Establish network segmentation boundaries "
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "CIS_Azure_2.0.0_6.7",
          "CIS_Azure_2.0.0_6.4",
          "CIS_Azure_2.0.0_6.3",
          "CIS_Azure_2.0.0_6.2",
          "CIS_Azure_2.0.0_6.1",
          "CIS_Azure_2.0.0_4.3.7",
          "NIST_SP_800-53_R4_SC-7",
          "NIST_SP_800-53_R4_SC-2",
          "NIST_SP_800-53_R4_AC-4",
          "PCI_DSS_v4.0_1.4.5",
          "PCI_DSS_v4.0_1.4.4",
          "PCI_DSS_v4.0_1.4.3",
          "PCI_DSS_v4.0_1.4.2",
          "PCI_DSS_v4.0_1.4.1",
          "PCI_DSS_v4.0_1.3.2",
          "PCI_DSS_v4.0_1.3.1",
          "PCI_DSS_v4.0_1.2.6"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}