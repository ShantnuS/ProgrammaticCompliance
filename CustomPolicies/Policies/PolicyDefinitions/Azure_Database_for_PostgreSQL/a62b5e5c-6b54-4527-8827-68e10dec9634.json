{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/a62b5e5c-6b54-4527-8827-68e10dec9634",
  "name": "a62b5e5c-6b54-4527-8827-68e10dec9634",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item IM-3 for Azure Database for PostgreSQL",
    "displayName": "MCSB Baseline item IM-3 for Azure Database for PostgreSQL",
    "metadata": {
      "offeringName": "Azure Database for PostgreSQL",
      "offeringId": "84bda2ea-972f-4aaa-ab08-324e9982fbcd",
      "mcsb": {
        "mcsbId": "IM-3",
        "features": [
          {
            "featureId": "MANAGED_IDENTITIES",
            "featureName": "Managed Identities",
            "featureDescription": "Data plane actions support authentication using managed identities.",
            "featureSupport": "True",
            "featureGuidance": "Use Azure managed identities instead of service principals when possible, which can authenticate to Azure services and resources that support Azure Active Directory (Azure AD) authentication. Managed identity credentials are fully managed, rotated, and protected by the platform, avoiding hard-coded credentials in source code or configuration files.",
            "featureReference": "https://learn.microsoft.com/azure/postgresql/flexible-server/how-to-connect-with-managed-identity",
            "enabledByDefault": "False",
            "customerActionsDescription": "Manage application identities securely and automatically"
          },
          {
            "featureId": "SERVICE_PRINCIPAL",
            "featureName": "Service Principals",
            "featureDescription": "Data plane supports authentication using service principals.",
            "featureSupport": "True",
            "featureGuidance": "There is no current Microsoft guidance for this feature configuration. Please review and determine if your organization wants to configure this security feature.",
            "featureReference": "Not Applicable",
            "enabledByDefault": "False",
            "customerActionsDescription": "Manage application identities securely and automatically"
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "NIST_SP_800-53_R4_IA-9",
          "NIST_SP_800-53_R4_IA-5",
          "NIST_SP_800-53_R4_IA-4",
          "NIST_SP_800-53_R4_AC-3",
          "NIST_SP_800-53_R4_AC-2",
          "PCI_DSS_v4.0_8.6.3",
          "PCI_DSS_v4.0_8.6.2",
          "PCI_DSS_v4.0_8.6.1"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}