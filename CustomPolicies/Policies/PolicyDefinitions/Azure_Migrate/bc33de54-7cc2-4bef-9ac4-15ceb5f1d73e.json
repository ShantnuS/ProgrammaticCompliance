{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/bc33de54-7cc2-4bef-9ac4-15ceb5f1d73e",
  "name": "bc33de54-7cc2-4bef-9ac4-15ceb5f1d73e",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item NS-2 for Azure Migrate",
    "displayName": "MCSB Baseline item NS-2 for Azure Migrate",
    "metadata": {
      "offeringName": "Azure Migrate",
      "offeringId": "9d8a7fdc-4f15-4682-b589-78a85286c82c",
      "mcsb": {
        "mcsbId": "NS-2",
        "features": [
          {
            "featureId": "DISABLE_PUBLIC_NETWORK_ACCESS",
            "featureName": "Disable Public Network Access",
            "featureDescription": "Service supports disabling public network access either through using service-level IP ACL filtering rule (not NSG or Azure Firewall) or using a 'Disable Public Network Access' toggle switch.",
            "featureSupport": "True",
            "featureGuidance": "Disable public network access using by toggling the switch for public network access. \r\n\r\nYou can configure the connectivity method for your Azure Migrate project and choose to enable or disable public network access to the Migrate project.",
            "featureReference": "https://docs.microsoft.com/azure/migrate/discover-and-assess-using-private-endpoints",
            "enabledByDefault": "False",
            "customerActionsDescription": "Secure cloud native services with network controls"
          },
          {
            "featureId": "PRIVATE_LINK_SUPPORT",
            "featureName": "Azure Private Link",
            "featureDescription": "Service native IP filtering capability for filtering network traffic (not to be confused with NSG or Azure Firewall).",
            "featureSupport": "True",
            "featureGuidance": "Deploy private endpoints for all Azure resources that support the Private Link feature, to establish a private access point for the resources. \r\n\r\nAzure Migrate Private Link support allows customers to securely discover, assess, and migrate servers over a private network while offering protection against data exfiltration risks and enabling greater migration velocity. \r\n \r\nYou can connect privately and securely to Azure Migrate over an Azure ExpressRoute private peering or a site-to-site (S2S) VPN connection by using Private Link.",
            "featureReference": "https://docs.microsoft.com/azure/migrate/discover-and-assess-using-private-endpoints",
            "enabledByDefault": "False",
            "customerActionsDescription": "Secure cloud native services with network controls"
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "CIS_Azure_2.0.0_6.7",
          "CIS_Azure_2.0.0_5.1.3",
          "CIS_Azure_2.0.0_4.5.2",
          "CIS_Azure_2.0.0_4.5.1",
          "CIS_Azure_2.0.0_4.1.2",
          "CIS_Azure_2.0.0_3.10",
          "CIS_Azure_2.0.0_3.9",
          "CIS_Azure_2.0.0_3.8",
          "CIS_Azure_2.0.0_3.7",
          "NIST_SP_800-53_R4_AC-4",
          "NIST_SP_800-53_R4_SC-7",
          "NIST_SP_800-53_R4_SC-2",
          "PCI_DSS_v4.0_1.4.5",
          "PCI_DSS_v4.0_1.4.4",
          "PCI_DSS_v4.0_1.4.3",
          "PCI_DSS_v4.0_1.4.2",
          "PCI_DSS_v4.0_1.4.1",
          "PCI_DSS_v4.0_1.3.2",
          "PCI_DSS_v4.0_1.3.1",
          "PCI_DSS_v4.0_1.2.6"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}