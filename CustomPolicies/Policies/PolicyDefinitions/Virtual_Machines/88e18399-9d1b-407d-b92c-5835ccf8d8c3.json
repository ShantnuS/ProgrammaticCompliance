{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/88e18399-9d1b-407d-b92c-5835ccf8d8c3",
  "name": "88e18399-9d1b-407d-b92c-5835ccf8d8c3",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item AM-5 for Virtual Machines",
    "displayName": "MCSB Baseline item AM-5 for Virtual Machines",
    "metadata": {
      "offeringName": "Virtual Machines",
      "offeringId": "07649cbd-2ee4-4992-898b-f5f16bad1b36",
      "mcsb": {
        "mcsbId": "AM-5",
        "features": [
          {
            "featureId": "ADAPTIVE_APPLICATION_CONTROLS",
            "featureName": "Microsoft Defender for Cloud - Adaptive Application Controls",
            "featureDescription": "Service can limit what customer applications run on the virtual machine using Adaptive Application Controls in Microsoft Defender for Cloud.",
            "featureSupport": "True",
            "featureGuidance": "Use Microsoft Defender for Cloud adaptive application controls to discover applications running on virtual machines (VMs) and generate an application allow list to mandate which approved applications can run in the VM environment.",
            "featureReference": "https://learn.microsoft.com/azure/defender-for-cloud/adaptive-application-controls",
            "enabledByDefault": "False",
            "customerActionsDescription": "Use only approved applications in virtual machine"
          }
        ],
        "automatedPolicyAvailability": [
          {
            "policyId": "47a6b606-51aa-4496-8bb7-64b11cf66adc",
            "policyName": "Adaptive application controls for defining safe applications should be enabled on your machines",
            "policyDescription": "Enable application controls to define the list of known-safe applications running on your machines, and alert you when other applications run. This helps harden your machines against malware. To simplify the process of configuring and maintaining your rules, Security Center uses machine learning to analyze the applications running on each machine and suggest the list of known-safe applications.",
            "policyCategory": "Security Center"
          },
          {
            "policyId": "123a3936-f020-408a-ba0c-47873faf1534",
            "policyName": "Allowlist rules in your adaptive application control policy should be updated",
            "policyDescription": "Monitor for changes in behavior on groups of machines configured for auditing by Azure Security Center's adaptive application controls. Security Center uses machine learning to analyze the running processes on your machines and suggest a list of known-safe applications. These are presented as recommended apps to allow in adaptive application control policies.",
            "policyCategory": "Security Center"
          }
        ],
        "frameworkControls": [
          "CIS_Azure_2.0.0_7.5",
          "NIST_SP_800-53_R4_CM-8",
          "NIST_SP_800-53_R4_CM-11",
          "NIST_SP_800-53_R4_CM-10",
          "NIST_SP_800-53_R4_CM-7",
          "PCI_DSS_v4.0_2.2.6",
          "PCI_DSS_v4.0_2.2.5",
          "PCI_DSS_v4.0_2.2.4"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}