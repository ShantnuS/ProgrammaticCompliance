{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/2e3abba6-8c42-4e79-93fa-e714d0b99866",
  "name": "2e3abba6-8c42-4e79-93fa-e714d0b99866",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item LT-1 for Azure Kubernetes Service (AKS)",
    "displayName": "MCSB Baseline item LT-1 for Azure Kubernetes Service (AKS)",
    "metadata": {
      "offeringName": "Azure Kubernetes Service (AKS)",
      "offeringId": "1f30fa84-8aae-4c27-92cf-f77bfdaf5958",
      "mcsb": {
        "mcsbId": "LT-1",
        "features": [
          {
            "featureId": "DEFENDER_FOR_SERVICE_SUPPORT",
            "featureName": "Microsoft Defender for Service / Product Offering",
            "featureDescription": "Service has an offering-specific Microsoft Defender solution to monitor and alert on security issues.",
            "featureSupport": "True",
            "featureGuidance": "Microsoft Defender for Containers is the cloud-native solution that is used to secure your containers so you can improve, monitor, and maintain the security of your clusters, containers, and their applications.",
            "featureReference": "https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-enable?tabs=aks-deploy-portal%2Ck8s-deploy-asc%2Ck8s-verify-asc%2Ck8s-remove-arc%2Caks-removeprofile-api&pivots=defender-for-container-aks&toc=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fazure%2Faks%2Ftoc.json&bc=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fazure%2Fbread%2Ftoc.json",
            "enabledByDefault": "False",
            "customerActionsDescription": "Enable threat detection capabilities"
          }
        ],
        "automatedPolicyAvailability": [
          {
            "policyId": "1c988dd6-ade4-430f-a608-2a3e5b0a6d38",
            "policyName": "Microsoft Defender for Containers should be enabled",
            "policyDescription": "Microsoft Defender for Containers provides hardening, vulnerability assessment and run-time protections for your Azure, hybrid, and multi-cloud Kubernetes environments.",
            "policyCategory": "Security Center"
          },
          {
            "policyId": "a1840de2-8088-4ea8-b153-b4c723e9cb01",
            "policyName": "Azure Kubernetes Service clusters should have Defender profile enabled",
            "policyDescription": "Microsoft Defender for Containers provides cloud-native Kubernetes security capabilities including environment hardening, workload protection, and run-time protection. When you enable the SecurityProfile.AzureDefender on your Azure Kubernetes Service cluster, an agent is deployed to your cluster to collect security event data. Learn more about Microsoft Defender for Containers in https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-introduction?tabs=defender-for-container-arch-aks",
            "policyCategory": "Kubernetes"
          }
        ],
        "frameworkControls": [
          "CIS_Azure_2.0.0_2.2.1",
          "CIS_Azure_2.0.0_2.1.12",
          "CIS_Azure_2.0.0_2.1.11",
          "CIS_Azure_2.0.0_2.1.10",
          "CIS_Azure_2.0.0_2.1.9",
          "CIS_Azure_2.0.0_2.1.8",
          "CIS_Azure_2.0.0_2.1.7",
          "CIS_Azure_2.0.0_2.1.6",
          "CIS_Azure_2.0.0_2.1.5",
          "CIS_Azure_2.0.0_2.1.4",
          "CIS_Azure_2.0.0_2.1.3",
          "CIS_Azure_2.0.0_2.1.2",
          "NIST_SP_800-53_R4_SI-4",
          "NIST_SP_800-53_R4_AU-12",
          "NIST_SP_800-53_R4_AU-6",
          "NIST_SP_800-53_R4_AU-3",
          "PCI_DSS_v4.0_10.7.3",
          "PCI_DSS_v4.0_10.7.2",
          "PCI_DSS_v4.0_10.7.1",
          "PCI_DSS_v4.0_10.4.3",
          "PCI_DSS_v4.0_10.4.2",
          "PCI_DSS_v4.0_10.4.1",
          "PCI_DSS_v4.0_10.2.2",
          "PCI_DSS_v4.0_10.2.1"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}