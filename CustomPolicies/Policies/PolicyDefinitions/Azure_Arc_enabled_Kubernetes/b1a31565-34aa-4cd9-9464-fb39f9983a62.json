{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/b1a31565-34aa-4cd9-9464-fb39f9983a62",
  "name": "b1a31565-34aa-4cd9-9464-fb39f9983a62",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item IM-7 for Azure Arc enabled Kubernetes",
    "displayName": "MCSB Baseline item IM-7 for Azure Arc enabled Kubernetes",
    "metadata": {
      "offeringName": "Azure Arc enabled Kubernetes",
      "offeringId": "2a133e7d-626b-4846-b8bb-96e683c13213",
      "mcsb": {
        "mcsbId": "IM-7",
        "features": [
          {
            "featureId": "CONDITIONAL_ACCESS",
            "featureName": "Conditional Access for Data Plane",
            "featureDescription": "Data plane access can be controlled using Azure AD Conditional Access Policies.",
            "featureSupport": "True",
            "featureGuidance": "By using the Azure RBAC feature, you can use Azure Active Directory (Azure AD) and role assignments in Azure to control authorization checks on the cluster. This implies that you can now use Azure role assignments to granularly control who can read, write, and delete Kubernetes objects like deployment, pod, and service.\r\n\r\nYou can add further configuration to enable conditional access. See reference link below.",
            "featureReference": "https://docs.microsoft.com/azure/azure-arc/kubernetes/azure-rbac#use-conditional-access-with-azure-ad",
            "enabledByDefault": "False",
            "customerActionsDescription": "Restrict resource access based on  conditions"
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "CIS_Azure_2.0.0_1.2.6",
          "CIS_Azure_2.0.0_1.2.5",
          "CIS_Azure_2.0.0_1.2.4",
          "CIS_Azure_2.0.0_1.2.3",
          "CIS_Azure_2.0.0_1.2.2",
          "CIS_Azure_2.0.0_1.2.1",
          "NIST_SP_800-53_R4_AC-3",
          "NIST_SP_800-53_R4_AC-2",
          "NIST_SP_800-53_R4_AC-6"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}