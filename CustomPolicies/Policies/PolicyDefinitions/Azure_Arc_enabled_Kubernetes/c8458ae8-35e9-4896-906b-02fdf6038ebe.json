{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/c8458ae8-35e9-4896-906b-02fdf6038ebe",
  "name": "c8458ae8-35e9-4896-906b-02fdf6038ebe",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item LT-1 for Azure Arc enabled Kubernetes",
    "displayName": "MCSB Baseline item LT-1 for Azure Arc enabled Kubernetes",
    "metadata": {
      "offeringName": "Azure Arc enabled Kubernetes",
      "offeringId": "2a133e7d-626b-4846-b8bb-96e683c13213",
      "mcsb": {
        "mcsbId": "LT-1",
        "features": [
          {
            "featureId": "DEFENDER_FOR_SERVICE_SUPPORT",
            "featureName": "Microsoft Defender for Service / Product Offering",
            "featureDescription": "Service has an offering-specific Microsoft Defender solution to monitor and alert on security issues.",
            "featureSupport": "True",
            "featureGuidance": "Microsoft Defender for Cloud is a cloud-native tool that allows for implementation of guardrails, controls, reports, alerts and remediation tasks in an automated fashion at scale. By combining it with Azure Arc-enabled Kubernetes, you can extend security checks to any Kubernetes cluster in your on-premises and/or multi-cloud environment. \r\n\r\nPlease refer to this article: [Governance, security, and compliance baseline for Azure Arc-enabled Kubernetes](https://docs.microsoft.com/azure/cloud-adoption-framework/scenarios/hybrid/arc-enabled-kubernetes/eslz-arc-kubernetes-governance-disciplines)",
            "featureReference": "https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-enable?pivots=defender-for-container-arc&toc=%2Fazure%2Fazure-arc%2Fkubernetes%2Ftoc.json&bc=%2Fazure%2Fazure-arc%2Fkubernetes%2Fbreadcrumb%2Ftoc.json&tabs=aks-deploy-portal%2Ck8s-deploy-asc%2Ck8s-verify-asc%2Ck8s-remove-arc%2Caks-removeprofile-api#protect-arc-enabled-kubernetes-clusters",
            "enabledByDefault": "False",
            "customerActionsDescription": "Enable threat detection capabilities"
          }
        ],
        "automatedPolicyAvailability": [
          {
            "policyId": "1c988dd6-ade4-430f-a608-2a3e5b0a6d38",
            "policyName": "Microsoft Defender for Containers should be enabled",
            "policyDescription": "Microsoft Defender for Containers provides hardening, vulnerability assessment and run-time protections for your Azure, hybrid, and multi-cloud Kubernetes environments.",
            "policyCategory": "Security Center"
          },
          {
            "policyId": "8dfab9c4-fe7b-49ad-85e4-1e9be085358f",
            "policyName": "[Preview]: Azure Arc enabled Kubernetes clusters should have Microsoft Defender for Cloud extension installed",
            "policyDescription": "Microsoft Defender for Cloud extension for Azure Arc provides threat protection for your Arc enabled Kubernetes clusters. The extension collects data from all nodes in the cluster and sends it to the Azure Defender for Kubernetes backend in the cloud for further analysis. Learn more in https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-enable?pivots=defender-for-container-arc.",
            "policyCategory": "Kubernetes"
          }
        ],
        "frameworkControls": [
          "CIS_Azure_2.0.0_2.2.1",
          "CIS_Azure_2.0.0_2.1.12",
          "CIS_Azure_2.0.0_2.1.11",
          "CIS_Azure_2.0.0_2.1.10",
          "CIS_Azure_2.0.0_2.1.9",
          "CIS_Azure_2.0.0_2.1.8",
          "CIS_Azure_2.0.0_2.1.7",
          "CIS_Azure_2.0.0_2.1.6",
          "CIS_Azure_2.0.0_2.1.5",
          "CIS_Azure_2.0.0_2.1.4",
          "CIS_Azure_2.0.0_2.1.3",
          "CIS_Azure_2.0.0_2.1.2",
          "NIST_SP_800-53_R4_SI-4",
          "NIST_SP_800-53_R4_AU-12",
          "NIST_SP_800-53_R4_AU-6",
          "NIST_SP_800-53_R4_AU-3",
          "PCI_DSS_v4.0_10.7.3",
          "PCI_DSS_v4.0_10.7.2",
          "PCI_DSS_v4.0_10.7.1",
          "PCI_DSS_v4.0_10.4.3",
          "PCI_DSS_v4.0_10.4.2",
          "PCI_DSS_v4.0_10.4.1",
          "PCI_DSS_v4.0_10.2.2",
          "PCI_DSS_v4.0_10.2.1"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}