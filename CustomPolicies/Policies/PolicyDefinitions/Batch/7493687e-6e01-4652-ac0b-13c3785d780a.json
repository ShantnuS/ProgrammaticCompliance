{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/7493687e-6e01-4652-ac0b-13c3785d780a",
  "name": "7493687e-6e01-4652-ac0b-13c3785d780a",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item PV-3 for Batch",
    "displayName": "MCSB Baseline item PV-3 for Batch",
    "metadata": {
      "offeringName": "Batch",
      "offeringId": "4ebe0f40-9ea7-45b0-bf47-c86cf700a073",
      "mcsb": {
        "mcsbId": "PV-3",
        "features": [
          {
            "featureId": "AZURE_AUTOMATION_STATE_CONFIGURATION",
            "featureName": "Azure Automation State Configuration",
            "featureDescription": "Azure Automation State Configuration can be used to maintain the security configuration of the operating system.",
            "featureSupport": "False",
            "featureGuidance": "This feature is not supported to secure this service.",
            "featureReference": "Not Applicable",
            "enabledByDefault": "Not Applicable",
            "customerActionsDescription": "Define and establish secure configurations for compute resources"
          },
          {
            "featureId": "AZURE_POLICY_GUEST_CONFIGURATION_AGENT",
            "featureName": "Azure Policy Guest Configuration Agent",
            "featureDescription": "Azure Policy guest configuration agent can be installed or deployed as an extension to compute resources.",
            "featureSupport": "False",
            "featureGuidance": "This feature is not supported to secure this service.",
            "featureReference": "Not Applicable",
            "enabledByDefault": "Not Applicable",
            "customerActionsDescription": "Define and establish secure configurations for compute resources"
          },
          {
            "featureId": "CUSTOM_CONTAINER_IMAGE_SUPPORTED",
            "featureName": "Custom Containers Images",
            "featureDescription": "Service supports using user-supplied container images or pre-built images from the marketplace with certain baseline configurations pre-applied.",
            "featureSupport": "True",
            "featureGuidance": "If using Batch pool to run tasks in Docker-compatible containers on the nodes, use pre-configured hardened container images from a trusted supplier such as Microsoft or build the desired secure configuration baseline into the container image template.",
            "featureReference": "https://docs.microsoft.com/azure/batch/batch-docker-container-workloads",
            "enabledByDefault": "False",
            "customerActionsDescription": "Define and establish secure configurations for compute resources"
          },
          {
            "featureId": "CUSTOM_MACHINE_OR_CONTAINER_IMAGE_SUPPORTED",
            "featureName": "Custom VM Images",
            "featureDescription": "Service supports using user-supplied VM images or pre-built images from the marketplace with certain baseline configurations pre-applied.",
            "featureSupport": "True",
            "featureGuidance": "When possible, use a pre-configured hardened image from a trusted supplier such as Microsoft or build a desired secure configuration baseline into the VM image template.\r\n\r\nCustomers may also use custom operating system images for Azure Batch. When using the virtual machine configuration for your Azure Batch, ensure custom images are hardened to your organization's needs. For lifecycle management, the pools store the images in a shared image gallery. You can set up a secure image build process using Azure automation tools, such as Azure Image Builder.",
            "featureReference": "https://docs.microsoft.com/azure/batch/batch-custom-images",
            "enabledByDefault": "False",
            "customerActionsDescription": "Define and establish secure configurations for compute resources"
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "CIS_Azure_2.0.0_9.9",
          "CIS_Azure_2.0.0_9.8",
          "CIS_Azure_2.0.0_9.7",
          "CIS_Azure_2.0.0_9.6",
          "NIST_SP_800-53_R4_CM-6",
          "NIST_SP_800-53_R4_CM-2",
          "PCI_DSS_v4.0_2.2.6",
          "PCI_DSS_v4.0_2.2.5",
          "PCI_DSS_v4.0_2.2.4",
          "PCI_DSS_v4.0_2.2.1"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}