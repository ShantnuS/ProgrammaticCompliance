{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/2f531c50-ecf7-4bda-b942-c2ca5823fbda",
  "name": "2f531c50-ecf7-4bda-b942-c2ca5823fbda",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item IM-3 for IoT Central",
    "displayName": "MCSB Baseline item IM-3 for IoT Central",
    "metadata": {
      "offeringName": "IoT Central",
      "offeringId": "c8be96e2-b091-4fc9-8b93-7defdb0eb66f",
      "mcsb": {
        "mcsbId": "IM-3",
        "features": [
          {
            "featureId": "MANAGED_IDENTITIES",
            "featureName": "Managed Identities",
            "featureDescription": "Data plane actions support authentication using managed identities.",
            "featureSupport": "True",
            "featureGuidance": "IoT Central supports system-assigned managed identities to secure connectivity to data egress destinations configured via continuous data export feature.\r\n\r\nLearn more about [configuring a managed identity for IoT Central applications]( https://docs.microsoft.com/azure/iot-central/core/howto-manage-iot-central-from-portal#configure-a-managed-identity)\r\n\r\nLearn more about [using managed identities to secure connection to export destinations]( https://docs.microsoft.com/azure/iot-central/core/overview-iot-central-security#authenticate-to-other-services)",
            "featureReference": "https://docs.microsoft.com/azure/iot-central/core/howto-manage-iot-central-from-portal#configure-a-managed-identity",
            "enabledByDefault": "False",
            "customerActionsDescription": "Manage application identities securely and automatically"
          },
          {
            "featureId": "SERVICE_PRINCIPAL",
            "featureName": "Service Principals",
            "featureDescription": "Data plane supports authentication using service principals.",
            "featureSupport": "True",
            "featureGuidance": "IoT Central supports adding Service Principals to data plane access. The service principal must belong to the same Azure Active Directory tenant as the Azure subscription associated with the IoT Central application.\r\n\r\nLearn more about [how to add service principals as users](https://docs.microsoft.com/azure/iot-central/core/howto-manage-users-roles#add-users)\r\n\r\nThe Azure Active Directory bearer token associated with the Service Principal can also be used to authenticate and authorize REST API calls.\r\n\r\nLearn more about [authenticating and authorizing IoT Central REST API calls]( https://docs.microsoft.com/azure/iot-central/core/howto-authorize-rest-api)",
            "featureReference": "https://docs.microsoft.com/rest/api/iotcentral/authentication#service-principal-authentication",
            "enabledByDefault": "False",
            "customerActionsDescription": "Manage application identities securely and automatically"
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "NIST_SP_800-53_R4_IA-5",
          "NIST_SP_800-53_R4_AC-3",
          "NIST_SP_800-53_R4_AC-2",
          "NIST_SP_800-53_R4_IA-9",
          "NIST_SP_800-53_R4_IA-4",
          "PCI_DSS_v4.0_8.6.2",
          "PCI_DSS_v4.0_8.6.3",
          "PCI_DSS_v4.0_8.6.1"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}