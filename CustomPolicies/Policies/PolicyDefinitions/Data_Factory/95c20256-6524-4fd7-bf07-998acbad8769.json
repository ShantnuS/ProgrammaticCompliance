{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/95c20256-6524-4fd7-bf07-998acbad8769",
  "name": "95c20256-6524-4fd7-bf07-998acbad8769",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item NS-2 for Data Factory",
    "displayName": "MCSB Baseline item NS-2 for Data Factory",
    "metadata": {
      "offeringName": "Data Factory",
      "offeringId": "d5fbb83d-baa0-4d89-82ca-73476c963144",
      "mcsb": {
        "mcsbId": "NS-2",
        "features": [
          {
            "featureId": "DISABLE_PUBLIC_NETWORK_ACCESS",
            "featureName": "Disable Public Network Access",
            "featureDescription": "Service supports disabling public network access either through using service-level IP ACL filtering rule (not NSG or Azure Firewall) or using a 'Disable Public Network Access' toggle switch.",
            "featureSupport": "True",
            "featureGuidance": "There is no current Microsoft guidance for this feature configuration. Please review and determine if your organization wants to configure this security feature.",
            "featureReference": "https://docs.microsoft.com/azure/data-factory/data-factory-private-link",
            "enabledByDefault": "False",
            "customerActionsDescription": "Secure cloud native services with network controls"
          },
          {
            "featureId": "PRIVATE_LINK_SUPPORT",
            "featureName": "Azure Private Link",
            "featureDescription": "Service native IP filtering capability for filtering network traffic (not to be confused with NSG or Azure Firewall).",
            "featureSupport": "True",
            "featureGuidance": "You can configure private endpoints in the Azure Data Factory Managed Virtual Network to connect to data stores privately.\r\n\r\nData Factory doesn't provide the capability to configure Virtual Network service endpoints.\r\n\r\nWhen you create an Azure-SSIS Integration Runtime (IR), you can join it with a virtual network. It allows Azure Data Factory to create certain network resources, like an NSG and a load balancer. You can also provide your own static public IP address or have Azure Data Factory create one for you. On the NSG that is automatically created by Azure Data Factory, Port 3389 is open to all traffic by default. Lock the port down to ensure that only your administrators have access. You can deploy Self-Hosted IRs on an on-premises machine or Azure VM inside a virtual network. Make sure that your virtual network subnet deployment has an NSG configured to allow only administrative access. Azure-SSIS IR disallows port 3389 outbound by default at the Windows Firewall Rule on each IR node for protection. You can secure your virtual network-configured resources by associating an NSG with the subnet and setting strict rules.",
            "featureReference": "https://docs.microsoft.com/azure/data-factory/data-factory-private-link",
            "enabledByDefault": "False",
            "customerActionsDescription": "Secure cloud native services with network controls"
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "CIS_Azure_2.0.0_6.7",
          "CIS_Azure_2.0.0_5.1.3",
          "CIS_Azure_2.0.0_4.5.2",
          "CIS_Azure_2.0.0_4.5.1",
          "CIS_Azure_2.0.0_4.1.2",
          "CIS_Azure_2.0.0_3.10",
          "CIS_Azure_2.0.0_3.9",
          "CIS_Azure_2.0.0_3.8",
          "CIS_Azure_2.0.0_3.7",
          "NIST_SP_800-53_R4_AC-4",
          "NIST_SP_800-53_R4_SC-7",
          "NIST_SP_800-53_R4_SC-2",
          "PCI_DSS_v4.0_1.4.5",
          "PCI_DSS_v4.0_1.4.4",
          "PCI_DSS_v4.0_1.4.3",
          "PCI_DSS_v4.0_1.4.2",
          "PCI_DSS_v4.0_1.4.1",
          "PCI_DSS_v4.0_1.3.2",
          "PCI_DSS_v4.0_1.3.1",
          "PCI_DSS_v4.0_1.2.6"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}