{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/3850f394-f32a-46db-969b-0e6e6bf1bd16",
  "name": "3850f394-f32a-46db-969b-0e6e6bf1bd16",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item IM-3 for Container Registry",
    "displayName": "MCSB Baseline item IM-3 for Container Registry",
    "metadata": {
      "offeringName": "Container Registry",
      "offeringId": "e3ca8f4d-b86b-41eb-aa82-070498477c56",
      "mcsb": {
        "mcsbId": "IM-3",
        "features": [
          {
            "featureId": "MANAGED_IDENTITIES",
            "featureName": "Managed Identities",
            "featureDescription": "Data plane actions support authentication using managed identities.",
            "featureSupport": "True",
            "featureGuidance": "Use Azure managed identities instead of service principals when possible, which can authenticate to Azure services and resources that support Azure Active Directory (Azure AD) authentication. Managed identity credentials are fully managed, rotated, and protected by the platform, avoiding hard-coded credentials in source code or configuration files.",
            "featureReference": "https://docs.microsoft.com/azure/container-registry/container-registry-authentication-managed-identity",
            "enabledByDefault": "False",
            "customerActionsDescription": "Manage application identities securely and automatically"
          },
          {
            "featureId": "SERVICE_PRINCIPAL",
            "featureName": "Service Principals",
            "featureDescription": "Data plane supports authentication using service principals.",
            "featureSupport": "True",
            "featureGuidance": "Though service principals are supported by the service as a pattern for authentication, we recommend using Managed Identities where possible instead.",
            "featureReference": "https://docs.microsoft.com/azure/container-registry/container-registry-auth-service-principal",
            "enabledByDefault": "False",
            "customerActionsDescription": "Manage application identities securely and automatically"
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "NIST_SP_800-53_R4_IA-9",
          "NIST_SP_800-53_R4_IA-5",
          "NIST_SP_800-53_R4_IA-4",
          "NIST_SP_800-53_R4_AC-3",
          "NIST_SP_800-53_R4_AC-2",
          "PCI_DSS_v4.0_8.6.3",
          "PCI_DSS_v4.0_8.6.2",
          "PCI_DSS_v4.0_8.6.1"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}