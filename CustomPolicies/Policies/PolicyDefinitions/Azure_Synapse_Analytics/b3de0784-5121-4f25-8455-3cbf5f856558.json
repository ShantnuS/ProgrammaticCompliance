{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/b3de0784-5121-4f25-8455-3cbf5f856558",
  "name": "b3de0784-5121-4f25-8455-3cbf5f856558",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item DP-6 for Azure Synapse Analytics",
    "displayName": "MCSB Baseline item DP-6 for Azure Synapse Analytics",
    "metadata": {
      "offeringName": "Azure Synapse Analytics",
      "offeringId": "36bdbad1-7a98-45b6-bba9-5de8c197f991",
      "mcsb": {
        "mcsbId": "DP-6",
        "features": [
          {
            "featureId": "KEY_MANAGEMENT_IN_AZURE_KEY_VAULT",
            "featureName": "Key Management in Azure Key Vault",
            "featureDescription": "The service supports Azure Key Vault integration for any customer keys, secrets, or certificates.",
            "featureSupport": "True",
            "featureGuidance": "Use Azure Key Vault to create and control the life cycle of your encryption keys, including key generation, distribution, and storage. Rotate and revoke your keys in Azure Key Vault and your service based on a defined schedule or when there is a key retirement or compromise. When there is a need to use customer-managed key (CMK) in the workload, service, or application level, ensure you follow the best practices for key management: Use a key hierarchy to generate a separate data encryption key (DEK) with your key encryption key (KEK) in your key vault. Ensure keys are registered with Azure Key Vault and referenced via key IDs from the service or application. If you need to bring your own key (BYOK) to the service (such as importing HSM-protected keys from your on-premises HSMs into Azure Key Vault), follow recommended guidelines to perform initial key generation and key transfer.",
            "featureReference": "https://learn.microsoft.com/azure/synapse-analytics/security/workspaces-encryption",
            "enabledByDefault": "False",
            "customerActionsDescription": "Use a secure key management process"
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "CIS_Azure_2.0.0_8.8",
          "CIS_Azure_2.0.0_8.4",
          "CIS_Azure_2.0.0_8.3",
          "CIS_Azure_2.0.0_8.2",
          "CIS_Azure_2.0.0_8.1",
          "NIST_SP_800-53_R4_SC-28",
          "NIST_SP_800-53_R4_SC-12",
          "NIST_SP_800-53_R4_IA-5",
          "PCI_DSS_v4.0_4.2.1",
          "PCI_DSS_v4.0_3.6.1",
          "PCI_DSS_v4.0_12.3.3",
          "PCI_DSS_v4.0_3.7.9",
          "PCI_DSS_v4.0_3.7.8",
          "PCI_DSS_v4.0_3.7.7",
          "PCI_DSS_v4.0_3.7.6",
          "PCI_DSS_v4.0_3.7.5",
          "PCI_DSS_v4.0_3.7.4",
          "PCI_DSS_v4.0_3.7.3",
          "PCI_DSS_v4.0_3.7.2",
          "PCI_DSS_v4.0_3.7.1",
          "PCI_DSS_v4.0_3.5.1"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}