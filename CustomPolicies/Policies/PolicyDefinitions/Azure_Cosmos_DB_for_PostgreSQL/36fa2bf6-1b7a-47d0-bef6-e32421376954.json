{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/36fa2bf6-1b7a-47d0-bef6-e32421376954",
  "name": "36fa2bf6-1b7a-47d0-bef6-e32421376954",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item NS-2 for Azure Cosmos DB for PostgreSQL",
    "displayName": "MCSB Baseline item NS-2 for Azure Cosmos DB for PostgreSQL",
    "metadata": {
      "offeringName": "Azure Cosmos DB for PostgreSQL",
      "offeringId": "9eae4134-c080-476b-b56d-ba4d75ec2c4a",
      "mcsb": {
        "mcsbId": "NS-2",
        "features": [
          {
            "featureId": "DISABLE_PUBLIC_NETWORK_ACCESS",
            "featureName": "Disable Public Network Access",
            "featureDescription": "Service supports disabling public network access either through using service-level IP ACL filtering rule (not NSG or Azure Firewall) or using a 'Disable Public Network Access' toggle switch.",
            "featureSupport": "True",
            "featureGuidance": "Azure Cosmos DB for PostgreSQL doesn't support a button to disable public access. Customers need to understand that public and private access can be enabled in any combination they would like to. It also means that enabling private access won’t disable public access. To disable public access customers would need to do exactly that – clear all controls that allow public access.\r\n\r\n[Private access in Azure Cosmos DB for PostgreSQL](https://learn.microsoft.com/azure/postgresql/hyperscale/concepts-private-access)",
            "featureReference": "https://docs.microsoft.com/azure/postgresql/hyperscale/concepts-security-overview#network-security",
            "enabledByDefault": "False",
            "customerActionsDescription": "Secure cloud native services with network controls"
          },
          {
            "featureId": "PRIVATE_LINK_SUPPORT",
            "featureName": "Azure Private Link",
            "featureDescription": "Service native IP filtering capability for filtering network traffic (not to be confused with NSG or Azure Firewall).",
            "featureSupport": "True",
            "featureGuidance": "Enable private access for coordinator at the time of Azure Cosmos DB for PostgreSQL cluster provisioning. That would give hosts on the selected virtual network (VNet) and subnet access to the cluster's coordinator via a private IP address in the selected subnet.\r\nIf you need private access to worker nodes, add private endpoints for each worker node on Networking tab of your cluster after it is provisioned.",
            "featureReference": "https://docs.microsoft.com/azure/postgresql/hyperscale/concepts-private-access",
            "enabledByDefault": "False",
            "customerActionsDescription": "Secure cloud native services with network controls"
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "CIS_Azure_2.0.0_6.7",
          "CIS_Azure_2.0.0_5.1.3",
          "CIS_Azure_2.0.0_4.5.2",
          "CIS_Azure_2.0.0_4.5.1",
          "CIS_Azure_2.0.0_4.1.2",
          "CIS_Azure_2.0.0_3.10",
          "CIS_Azure_2.0.0_3.9",
          "CIS_Azure_2.0.0_3.8",
          "CIS_Azure_2.0.0_3.7",
          "NIST_SP_800-53_R4_AC-4",
          "NIST_SP_800-53_R4_SC-7",
          "NIST_SP_800-53_R4_SC-2",
          "PCI_DSS_v4.0_1.4.5",
          "PCI_DSS_v4.0_1.4.4",
          "PCI_DSS_v4.0_1.4.3",
          "PCI_DSS_v4.0_1.4.2",
          "PCI_DSS_v4.0_1.4.1",
          "PCI_DSS_v4.0_1.3.2",
          "PCI_DSS_v4.0_1.3.1",
          "PCI_DSS_v4.0_1.2.6"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}