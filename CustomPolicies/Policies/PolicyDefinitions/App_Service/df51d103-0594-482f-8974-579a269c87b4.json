{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/df51d103-0594-482f-8974-579a269c87b4",
  "name": "df51d103-0594-482f-8974-579a269c87b4",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item DP-3 for App Service",
    "displayName": "MCSB Baseline item DP-3 for App Service",
    "metadata": {
      "offeringName": "App Service",
      "offeringId": "c7f69506-5b4f-4751-b423-0095e68fad64",
      "mcsb": {
        "mcsbId": "DP-3",
        "features": [
          {
            "featureId": "DATA_IN_TRANSIT_ENCRYPTION",
            "featureName": "Data in Transit Encryption",
            "featureDescription": "Service supports data in-transit encryption for data plane.",
            "featureSupport": "True",
            "featureGuidance": "Use and enforce the default minimum version of TLS v1.2, configured in TLS/SSL settings, for encrypting all information in transit. Also ensure that all HTTP connection requests are redirected to HTTPS.",
            "featureReference": "https://docs.microsoft.com/azure/app-service/configure-ssl-certificate?tabs=apex%2Cportal",
            "enabledByDefault": "False",
            "customerActionsDescription": "Encrypt sensitive data in transit"
          }
        ],
        "automatedPolicyAvailability": [
          {
            "policyId": "6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab",
            "policyName": "Function apps should only be accessible over HTTPS",
            "policyDescription": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
            "policyCategory": "App Service"
          },
          {
            "policyId": "a4af4a39-4135-47fb-b175-47fbdf85311d",
            "policyName": "App Service apps should only be accessible over HTTPS",
            "policyDescription": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
            "policyCategory": "App Service"
          },
          {
            "policyId": "f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
            "policyName": "App Service apps should use the latest TLS version",
            "policyDescription": "Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for App Service apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.",
            "policyCategory": "App Service"
          },
          {
            "policyId": "f9d614c5-c173-4d56-95a7-b4437057d193",
            "policyName": "Function apps should use the latest TLS version",
            "policyDescription": "Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for Function apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.",
            "policyCategory": "App Service"
          },
          {
            "policyId": "399b2637-a50f-4f95-96f8-3a145476eb15",
            "policyName": "Function apps should require FTPS only",
            "policyDescription": "Enable FTPS enforcement for enhanced security.",
            "policyCategory": "App Service"
          },
          {
            "policyId": "4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b",
            "policyName": "App Service apps should require FTPS only",
            "policyDescription": "Enable FTPS enforcement for enhanced security.",
            "policyCategory": "App Service"
          }
        ],
        "frameworkControls": [
          "CIS_Azure_2.0.0_9.3",
          "CIS_Azure_2.0.0_9.2",
          "CIS_Azure_2.0.0_4.4.1",
          "CIS_Azure_2.0.0_3.15",
          "CIS_Azure_2.0.0_2.1.5",
          "NIST_SP_800-53_R4_SC-8",
          "PCI_DSS_v4.0_4.2.2",
          "PCI_DSS_v4.0_4.2.1.2",
          "PCI_DSS_v4.0_2.2.7"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}