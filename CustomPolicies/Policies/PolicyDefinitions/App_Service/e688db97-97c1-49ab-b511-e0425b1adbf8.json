{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/e688db97-97c1-49ab-b511-e0425b1adbf8",
  "name": "e688db97-97c1-49ab-b511-e0425b1adbf8",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item DP-7 for App Service",
    "displayName": "MCSB Baseline item DP-7 for App Service",
    "metadata": {
      "offeringName": "App Service",
      "offeringId": "c7f69506-5b4f-4751-b423-0095e68fad64",
      "mcsb": {
        "mcsbId": "DP-7",
        "features": [
          {
            "featureId": "CERTIFICATE_MANAGEMENT_IN_AZURE_KEY_VAULT",
            "featureName": "Certificate Management in Azure Key Vault",
            "featureDescription": "The service supports Azure Key Vault integration for any customer certificates.",
            "featureSupport": "True",
            "featureGuidance": "App Service can be configured with SSL/TLS and other certificates, which can be configured directly on App Service or referenced from Key Vault. To ensure central management of all certificates and secrets, store any certificates used by App Service in Key Vault instead of deploying them locally on App Service directly. When this is configured App Service will automatically download the latest certificate from Azure Key Vault. Ensure the certificate generation follows defined standards without using any insecure properties, such as: insufficient key size, overly long validity period, insecure cryptography. Setup automatic rotation of the certificate in Azure Key Vault based on a defined schedule or when there is a certificate expiration.",
            "featureReference": "https://docs.microsoft.com/azure/app-service/configure-ssl-certificate",
            "enabledByDefault": "False",
            "customerActionsDescription": "Use a secure certificate management process"
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "NIST_SP_800-53_R4_IA-5",
          "NIST_SP_800-53_R4_SC-12",
          "NIST_SP_800-53_R4_SC-17",
          "PCI_DSS_v4.0_4.2.1"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}