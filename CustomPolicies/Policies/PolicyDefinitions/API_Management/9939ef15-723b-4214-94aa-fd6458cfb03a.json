{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/9939ef15-723b-4214-94aa-fd6458cfb03a",
  "name": "9939ef15-723b-4214-94aa-fd6458cfb03a",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item IM-8 for API Management",
    "displayName": "MCSB Baseline item IM-8 for API Management",
    "metadata": {
      "offeringName": "API Management",
      "offeringId": "7e1fb574-eb4a-45d7-8db2-c85445aac53f",
      "mcsb": {
        "mcsbId": "IM-8",
        "features": [
          {
            "featureId": "AKV_SUPPORT_FOR_CREDENTIAL_AND_SECRETS",
            "featureName": "Service Credential and Secrets Support Integration and Storage in Azure Key Vault",
            "featureDescription": "Data plane supports native use of Azure Key Vault for credential and secrets store.",
            "featureSupport": "True",
            "featureGuidance": "Set up integration of API Management with Azure Key Vault. Ensure that secrets for API Management (Named values) are stored an Azure Key Vault so they can be securely accessed and updated.",
            "featureReference": "https://docs.microsoft.com/azure/api-management/api-management-howto-properties",
            "enabledByDefault": "False",
            "customerActionsDescription": "Restrict the exposure of credential and secrets"
          }
        ],
        "automatedPolicyAvailability": [
          {
            "policyId": "f1cc7827-022c-473e-836e-5a51cae0b249",
            "policyName": "API Management secret named values should be stored in Azure Key Vault",
            "policyDescription": "Named values are a collection of name and value pairs in each API Management service. Secret values can be stored either as encrypted text in API Management (custom secrets) or by referencing secrets in Azure Key Vault. To improve security of API Management and secrets, reference secret named values from Azure Key Vault. Azure Key Vault supports granular access management and secret rotation policies.",
            "policyCategory": "API Management"
          },
          {
            "policyId": "549814b6-3212-4203-bdc8-1548d342fb67",
            "policyName": "API Management minimum API version should be set to 2019-12-01 or higher",
            "policyDescription": "To prevent service secrets from being shared with read-only users, the minimum API version should be set to 2019-12-01 or higher.",
            "policyCategory": "API Management"
          }
        ],
        "frameworkControls": [
          "CIS_Azure_2.0.0_3.3",
          "NIST_SP_800-53_R4_IA-5",
          "PCI_DSS_v4.0_8.6.2",
          "PCI_DSS_v4.0_3.6.1"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}