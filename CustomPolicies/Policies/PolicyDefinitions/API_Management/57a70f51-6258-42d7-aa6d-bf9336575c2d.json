{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/57a70f51-6258-42d7-aa6d-bf9336575c2d",
  "name": "57a70f51-6258-42d7-aa6d-bf9336575c2d",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item DP-6 for API Management",
    "displayName": "MCSB Baseline item DP-6 for API Management",
    "metadata": {
      "offeringName": "API Management",
      "offeringId": "7e1fb574-eb4a-45d7-8db2-c85445aac53f",
      "mcsb": {
        "mcsbId": "DP-6",
        "features": [
          {
            "featureId": "KEY_MANAGEMENT_IN_AZURE_KEY_VAULT",
            "featureName": "Key Management in Azure Key Vault",
            "featureDescription": "The service supports Azure Key Vault integration for any customer keys, secrets, or certificates.",
            "featureSupport": "True",
            "featureGuidance": "Set up integration of API Management with Azure Key Vault. Ensure that keys used by API Management are stored an Azure Key Vault so they can be securely accessed and updated.",
            "featureReference": "https://docs.microsoft.com/azure/api-management/api-management-howto-properties?tabs=azure-portal#prerequisites-for-key-vault-integration",
            "enabledByDefault": "False",
            "customerActionsDescription": "Use a secure key management process"
          }
        ],
        "automatedPolicyAvailability": [
          {
            "policyId": "f1cc7827-022c-473e-836e-5a51cae0b249",
            "policyName": "API Management secret named values should be stored in Azure Key Vault",
            "policyDescription": "Named values are a collection of name and value pairs in each API Management service. Secret values can be stored either as encrypted text in API Management (custom secrets) or by referencing secrets in Azure Key Vault. To improve security of API Management and secrets, reference secret named values from Azure Key Vault. Azure Key Vault supports granular access management and secret rotation policies.",
            "policyCategory": "API Management"
          }
        ],
        "frameworkControls": [
          "CIS_Azure_2.0.0_8.8",
          "CIS_Azure_2.0.0_8.4",
          "CIS_Azure_2.0.0_8.3",
          "CIS_Azure_2.0.0_8.2",
          "CIS_Azure_2.0.0_8.1",
          "NIST_SP_800-53_R4_IA-5",
          "NIST_SP_800-53_R4_SC-28",
          "NIST_SP_800-53_R4_SC-12",
          "PCI_DSS_v4.0_3.6.1",
          "PCI_DSS_v4.0_12.3.3",
          "PCI_DSS_v4.0_4.2.1",
          "PCI_DSS_v4.0_3.7.9",
          "PCI_DSS_v4.0_3.7.8",
          "PCI_DSS_v4.0_3.7.7",
          "PCI_DSS_v4.0_3.7.6",
          "PCI_DSS_v4.0_3.7.5",
          "PCI_DSS_v4.0_3.7.4",
          "PCI_DSS_v4.0_3.7.3",
          "PCI_DSS_v4.0_3.7.2",
          "PCI_DSS_v4.0_3.7.1",
          "PCI_DSS_v4.0_3.5.1"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}