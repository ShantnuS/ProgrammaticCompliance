{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/fb12c4d9-95e3-44e3-89e9-0baba40ac237",
  "name": "fb12c4d9-95e3-44e3-89e9-0baba40ac237",
  "properties": {
    "description": "Description Custom Manual - MCSB Baseline item IM-1 for API Management",
    "displayName": "MCSB Baseline item IM-1 for API Management",
    "metadata": {
      "offeringName": "API Management",
      "offeringId": "7e1fb574-eb4a-45d7-8db2-c85445aac53f",
      "mcsb": {
        "mcsbId": "IM-1",
        "features": [
          {
            "featureId": "AAD_AUTH_FOR_DATA_PLANE_ACCESS",
            "featureName": "Azure AD Authentication Required for Data Plane Access",
            "featureDescription": "Service supports using Azure AD authentication for data plane access.",
            "featureSupport": "True",
            "featureGuidance": "Use Azure Active Directory (Azure AD) as the default authentication method for API Management where possible.\r\n\r\n- Configure your Azure API Management Developer Portal to authenticate developer accounts by using Azure AD.\r\n- Configure your Azure API Management instance to protect your APIs by using the OAuth 2.0 protocol with Azure AD.",
            "featureReference": "https://docs.microsoft.com/azure/api-management/api-management-howto-protect-backend-with-aad",
            "enabledByDefault": "False",
            "customerActionsDescription": "Use centralized identity and authentication system"
          },
          {
            "featureId": "LOCAL_AUTH_METHODS_FOR_DATA_PLANE_ACCESS",
            "featureName": "Local Authentication Methods for Data Plane Access",
            "featureDescription": "Local authentications methods supported for data plane access, such as a local username and password.",
            "featureSupport": "True",
            "featureGuidance": "Restrict the use of local authentication methods for data plane access, maintain inventory of API Management user accounts and reconcile access as needed. In API Management, developers are the consumers of the APIs that exposed with API Management. By default, newly created developer accounts are Active, and associated with the Developers group. Developer accounts that are in an active state can be used to access all of the APIs for which they have subscriptions.\r\n\r\nAlso, Azure API Management subscriptions are one means of securing access to APIs and come with a pair of generated subscription keys which support rotation.\r\n\r\nInstead of using other auth methods, where possible use Azure Active Directory (Azure AD) as the default authentication method to control your data plane access.",
            "featureReference": "https://docs.microsoft.com/azure/api-management/api-management-authentication-policies#Basic",
            "enabledByDefault": "False",
            "customerActionsDescription": "Use centralized identity and authentication system"
          }
        ],
        "automatedPolicyAvailability": [],
        "frameworkControls": [
          "CIS_Azure_2.0.0_4.5.3",
          "CIS_Azure_2.0.0_9.5",
          "CIS_Azure_2.0.0_4.1.4",
          "NIST_SP_800-53_R4_AC-3",
          "NIST_SP_800-53_R4_AC-2",
          "NIST_SP_800-53_R4_IA-8",
          "NIST_SP_800-53_R4_IA-2",
          "PCI_DSS_v4.0_7.3.2",
          "PCI_DSS_v4.0_7.3.1",
          "PCI_DSS_v4.0_8.2.1"
        ]
      },
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "mode": "All",
    "policyType": "Custom",
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "in": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups"
            ]
          },
          {
            "value": "false",
            "equals": "true"
          }
        ]
      },
      "then": {
        "effect": "Manual",
        "details": {
          "defaultState": "Unknown"
        }
      }
    }
  }
}